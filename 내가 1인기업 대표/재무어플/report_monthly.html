<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³µë¦¬ íˆ¬ì ë¶„ì„ ë³´ê³ ì„œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: white;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-after: always;
            }
        }

        .report-header {
            border-bottom: 4px solid #10b981;
            padding-bottom: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-section {
            margin-bottom: 2rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            border: 1px solid #e5e7eb;
            padding: 0.75rem;
            text-align: left;
        }

        .data-table th {
            background-color: #f3f4f6;
            font-weight: 600;
        }

        .highlight-box {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
        }
    </style>
</head>

<body class="p-8 max-w-4xl mx-auto">
    <!-- í”„ë¦°íŠ¸ ë²„íŠ¼ -->
    <div class="no-print mb-6 text-right">
        <button onclick="window.print()"
            class="bg-green-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-green-700 transition">
            ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥
        </button>
    </div>

    <!-- í—¤ë” -->
    <div class="report-header">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-3xl font-black text-gray-900 mb-2">ë³µë¦¬ íˆ¬ì ë¶„ì„ ë³´ê³ ì„œ</h1>
                <p class="text-sm text-gray-500">Monthly Savings Compound Investment Report</p>
            </div>
            <div class="text-right text-sm text-gray-600">
                <p id="report-date"></p>
                <p class="font-bold text-green-600 mt-1">ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨</p>
            </div>
        </div>
    </div>

    <!-- ê³ ê° ì •ë³´ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ“‹ ê³ ê° ì •ë³´</h2>
        <table class="data-table">
            <tr>
                <th class="w-1/4">ê³ ê°ëª…</th>
                <td id="client-name"></td>
                <th class="w-1/4">ë‚˜ì´</th>
                <td id="client-age"></td>
            </tr>
            <tr>
                <th>ì¬ë¬´ ëª©ì </th>
                <td colspan="3" id="analysis-purpose"></td>
            </tr>
        </table>
    </div>

    <!-- ë³µë¦¬ íˆ¬ì ë¶„ì„ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ“ˆ ë³µë¦¬ íˆ¬ì ë¶„ì„</h2>

        <!-- ì…ë ¥ ì •ë³´ ìš”ì•½ -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ë¶„ì„ ì¡°ê±´</h3>
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <p class="text-sm text-green-800 mb-1">ì›” ì €ì¶•ì•¡</p>
                    <p class="text-2xl font-bold text-green-700" id="monthly-save"></p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <p class="text-sm text-blue-800 mb-1">ì˜ˆìƒ ìˆ˜ìµë¥ </p>
                    <p class="text-2xl font-bold text-blue-700" id="rate"></p>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                    <p class="text-sm text-purple-800 mb-1">íˆ¬ì ê¸°ê°„</p>
                    <p class="text-2xl font-bold text-purple-700" id="years"></p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <p class="text-sm text-gray-600 mb-1">í˜„ì¬ ë‚˜ì´ â†’ ë§Œê¸° ë‚˜ì´</p>
                    <p class="text-2xl font-bold text-gray-900"><span id="current-age"></span>ì„¸ â†’ <span
                            id="end-age"></span>ì„¸</p>
                </div>
            </div>
        </div>

        <!-- ë¶„ì„ ê²°ê³¼ -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ë¶„ì„ ê²°ê³¼</h3>
            <div class="grid grid-cols-3 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 text-center">
                    <p class="text-sm text-gray-600 mb-1">ì´ ë‚©ì… ì›ê¸ˆ</p>
                    <p class="text-xl font-black text-gray-700" id="total-principal"></p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 text-center">
                    <p class="text-sm text-blue-800 mb-1">ì´ ì´ì ìˆ˜ìµ</p>
                    <p class="text-xl font-black text-blue-700" id="total-interest"></p>
                </div>
                <div class="highlight-box">
                    <p class="text-sm text-green-100 mb-1">ìµœì¢… ìì‚°</p>
                    <p class="text-2xl font-black" id="final-amount"></p>
                </div>
            </div>
            <div class="mt-4 text-center bg-indigo-50 p-4 rounded-lg border border-indigo-200">
                <p class="text-sm text-indigo-800 mb-1">ì´ ìˆ˜ìµë¥ </p>
                <p class="text-3xl font-black text-indigo-700" id="yield-rate"></p>
            </div>
        </div>

        <!-- ì°¨íŠ¸ -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ìì‚° ì„±ì¥ ì¶”ì´</h3>
            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                <canvas id="reportChart" style="max-height: 300px;"></canvas>
            </div>
        </div>

        <!-- ìƒì„¸ í…Œì´ë¸” -->
        <div class="page-break">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ì—°ë„ë³„ ìƒì„¸ ë‚´ì—­ (5ë…„ ë‹¨ìœ„)</h3>
            <table class="data-table text-sm">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="text-center">ì—°ë„</th>
                        <th class="text-center">ë‚˜ì´</th>
                        <th class="text-right">ëˆ„ì  ë‚©ì…ì•¡</th>
                        <th class="text-right">ëˆ„ì  ì´ì</th>
                        <th class="text-right">ìì‚° ì´ì•¡</th>
                    </tr>
                </thead>
                <tbody id="detail-table-body">
                    <!-- JavaScriptë¡œ ìƒì„± -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- ê¶Œì¥ ì‚¬í•­ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ’¡ ì¬ë¬´ ì„¤ê³„ì‚¬ ê¶Œì¥ ì‚¬í•­</h2>
        <div class="bg-green-50 p-6 rounded-lg border-l-4 border-green-500">
            <ul class="space-y-2 text-gray-700">
                <li class="flex items-start gap-2">
                    <span class="text-green-600 font-bold">â€¢</span>
                    <span><span class="font-bold text-green-700">ë³µë¦¬ì˜ í˜</span>ìœ¼ë¡œ ì´ ìˆ˜ìµë¥  <span id="rec-yield"
                            class="font-bold"></span>ì„ ë‹¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-600 font-bold">â€¢</span>
                    <span>ê¾¸ì¤€í•œ ì›” ì €ì¶•ì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤. ì¤‘ë„ í•´ì§€ ì—†ì´ <span id="rec-years" class="font-bold"></span> ë™ì•ˆ ìœ ì§€í•˜ì‹œê¸°
                        ë°”ëë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-600 font-bold">â€¢</span>
                    <span>ì¥ê¸° íˆ¬ìì¼ìˆ˜ë¡ ë³µë¦¬ íš¨ê³¼ê°€ ê·¹ëŒ€í™”ë©ë‹ˆë‹¤. ê°€ëŠ¥í•˜ë‹¤ë©´ íˆ¬ì ê¸°ê°„ì„ ë” ëŠ˜ë¦¬ëŠ” ê²ƒì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-600 font-bold">â€¢</span>
                    <span>ì‹œì¥ ë³€ë™ì„±ì— í”ë“¤ë¦¬ì§€ ì•Šê³  ì¥ê¸°ì ì¸ ê´€ì ì„ ìœ ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</span>
                </li>
            </ul>
        </div>
    </div>

    <!-- ë©´ì±… ì¡°í•­ -->
    <div class="report-section text-xs text-gray-500 border-t pt-4 mt-8">
        <p class="mb-2">
            <strong>ë©´ì±… ì¡°í•­:</strong> ë³¸ ë³´ê³ ì„œì˜ ë¶„ì„ ê²°ê³¼ëŠ” ì…ë ¥ëœ ê°€ì •ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹œë®¬ë ˆì´ì…˜ì´ë©°, ì‹¤ì œ íˆ¬ì ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            íˆ¬ì ê²°ì • ì‹œì—ëŠ” ì‹œì¥ ìƒí™©, ê°œì¸ì˜ ì¬ë¬´ ìƒíƒœ, ë¦¬ìŠ¤í¬ ì„±í–¥ ë“±ì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
        </p>
        <p class="text-center mt-4 text-gray-400">
            Â© 2024-2026 ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨. All rights reserved.
        </p>
    </div>

    <script>
        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const params = new URLSearchParams(window.location.search);

        // ë‚ ì§œ ì„¤ì •
        document.getElementById('report-date').textContent = new Date().toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // ë°ì´í„° íŒŒì‹±
        const reportData = {
            clientName: params.get('clientName') || 'ê³ ê°ëª…',
            clientAge: params.get('clientAge') || '-',
            purpose: params.get('purpose') || 'ìì‚° í˜•ì„±',
            monthlySave: parseInt(params.get('monthlySave')) || 300000,
            rate: parseFloat(params.get('rate')) || 5,
            years: parseInt(params.get('years')) || 10,
            age: parseInt(params.get('age')) || 45,
            totalPrincipal: parseInt(params.get('totalPrincipal')) || 0,
            totalInterest: parseInt(params.get('totalInterest')) || 0,
            finalAmount: parseInt(params.get('finalAmount')) || 0,
            yieldRate: parseFloat(params.get('yieldRate')) || 0
        };

        const formatMoney = (n) => new Intl.NumberFormat('ko-KR').format(Math.round(n)) + 'ì›';

        // ê³ ê° ì •ë³´ í‘œì‹œ
        document.getElementById('client-name').textContent = reportData.clientName;
        document.getElementById('client-age').textContent = reportData.clientAge + 'ì„¸';
        document.getElementById('analysis-purpose').textContent = reportData.purpose;

        // ë¶„ì„ ì¡°ê±´ í‘œì‹œ
        document.getElementById('monthly-save').textContent = formatMoney(reportData.monthlySave);
        document.getElementById('rate').textContent = reportData.rate + '%';
        document.getElementById('years').textContent = reportData.years + 'ë…„';
        document.getElementById('current-age').textContent = reportData.age;
        document.getElementById('end-age').textContent = reportData.age + reportData.years;

        // ê²°ê³¼ í‘œì‹œ
        document.getElementById('total-principal').textContent = formatMoney(reportData.totalPrincipal);
        document.getElementById('total-interest').textContent = formatMoney(reportData.totalInterest);
        document.getElementById('final-amount').textContent = formatMoney(reportData.finalAmount);
        document.getElementById('yield-rate').textContent = reportData.yieldRate.toFixed(1) + '%';

        // ê¶Œì¥ ì‚¬í•­
        document.getElementById('rec-yield').textContent = reportData.yieldRate.toFixed(1) + '%';
        document.getElementById('rec-years').textContent = reportData.years + 'ë…„';

        // ì—°ë„ë³„ ë°ì´í„° ê³„ì‚°
        const yearlyData = [];
        const monthlyRate = reportData.rate / 100 / 12;

        for (let i = 1; i <= reportData.years; i++) {
            const months = i * 12;
            const principal = reportData.monthlySave * months;
            let total = 0;

            // ë³µë¦¬ ê³„ì‚°
            for (let m = 0; m < months; m++) {
                total = (total + reportData.monthlySave) * (1 + monthlyRate);
            }

            const interest = total - principal;

            yearlyData.push({
                year: i,
                age: reportData.age + i,
                principal,
                interest,
                total
            });
        }

        // í…Œì´ë¸” ìƒì„± (5ë…„ ë‹¨ìœ„)
        const tableBody = document.getElementById('detail-table-body');
        yearlyData.forEach((data) => {
            if (data.year % 5 === 0 || data.year === reportData.years) {
                const row = `
                    <tr class="${data.year === reportData.years ? 'bg-green-50 font-bold' : ''}">
                        <td class="text-center">${data.year}ë…„</td>
                        <td class="text-center">${data.age}ì„¸</td>
                        <td class="text-right">${formatMoney(data.principal)}</td>
                        <td class="text-right text-blue-600">+${formatMoney(data.interest)}</td>
                        <td class="text-right text-green-600">${formatMoney(data.total)}</td>
                    </tr>
                `;
                tableBody.insertAdjacentHTML('beforeend', row);
            }
        });

        // ì°¨íŠ¸ ìƒì„±
        const ctx = document.getElementById('reportChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: yearlyData.map(d => d.year + 'ë…„'),
                datasets: [
                    {
                        label: 'ëˆ„ì  ë‚©ì…ì•¡',
                        data: yearlyData.map(d => d.principal),
                        borderColor: '#9ca3af',
                        backgroundColor: 'rgba(156, 163, 175, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'ìì‚° ì´ì•¡',
                        data: yearlyData.map(d => d.total),
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        ticks: {
                            callback: (value) => {
                                if (value >= 100000000) return (value / 100000000).toFixed(0) + 'ì–µ';
                                if (value >= 10000) return (value / 10000).toFixed(0) + 'ë§Œ';
                                return value;
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>

</html>