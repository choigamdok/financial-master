<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì€í‡´ ìê¸ˆ ì„¤ê³„ ë³´ê³ ì„œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: white;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-after: always;
            }
        }

        .report-header {
            border-bottom: 4px solid #d97706;
            /* Amber-600 */
            padding-bottom: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-section {
            margin-bottom: 2rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            border: 1px solid #e5e7eb;
            padding: 0.75rem;
            text-align: left;
        }

        .data-table th {
            background-color: #fffbeb;
            /* Amber-50 */
            font-weight: 600;
        }

        .highlight-box {
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
        }

        .step-card {
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1rem;
            height: 100%;
            background-color: #fff;
        }

        .timeline-connector {
            flex-grow: 1;
            height: 4px;
            background-color: #e5e7eb;
            margin: 0 1rem;
            position: relative;
        }

        .timeline-connector::after {
            content: 'â–¶';
            position: absolute;
            right: -6px;
            top: -10px;
            color: #d1d5db;
            font-size: 14px;
        }
    </style>
</head>

<body class="p-8 max-w-4xl mx-auto">
    <!-- í”„ë¦°íŠ¸ ë²„íŠ¼ -->
    <div class="no-print mb-6 text-right">
        <button onclick="window.print()"
            class="bg-amber-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-amber-700 transition">
            ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥
        </button>
    </div>

    <!-- í—¤ë” -->
    <div class="report-header">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-3xl font-black text-gray-900 mb-2">ì€í‡´ ìê¸ˆ ì„¤ê³„ ë³´ê³ ì„œ</h1>
                <p class="text-sm text-gray-500">Retirement Financial Plan: The Golden Goose Strategy</p>
            </div>
            <div class="text-right text-sm text-gray-600">
                <p id="report-date"></p>
                <p class="font-bold text-amber-600 mt-1">ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨</p>
            </div>
        </div>
    </div>

    <!-- ê³ ê° ì •ë³´ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ“‹ ê³ ê° ì •ë³´</h2>
        <table class="data-table">
            <tr>
                <th class="w-1/4">ê³ ê°ëª…</th>
                <td id="client-name"></td>
                <th class="w-1/4">ë‚˜ì´</th>
                <td id="client-age"></td>
            </tr>
            <tr>
                <th>ì€í‡´ ëª©í‘œ</th>
                <td colspan="3"><span id="analysis-purpose"></span> (ì€í‡´ ì˜ˆì •: <span id="retire-age-val"></span>ì„¸)</td>
            </tr>
        </table>
    </div>

    <!-- ì€í‡´ ëª©í‘œ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ¯ ì€í‡´ ëª©í‘œ ì„¤ì •</h2>
        <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="bg-amber-50 p-4 rounded-lg border border-amber-200 text-center">
                <p class="text-sm text-amber-800 mb-1">í¬ë§ ì›” ìˆ˜ë ¹ì•¡ (ë°°ë‹¹)</p>
                <p class="text-3xl font-black text-amber-700" id="monthly-pension"></p>
                <p class="text-xs text-amber-600 mt-1">ì›ê¸ˆ ë³´ì¡´í˜• (ë°°ë‹¹ë¥  7% ê¸°ì¤€)</p>
            </div>
            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 text-center flex flex-col justify-center">
                <p class="text-sm text-gray-600 mb-1">í•„ìš”í•œ í™©ê¸ˆ ê±°ìœ„ (ëª©ëˆ)</p>
                <p class="text-2xl font-black text-gray-800" id="target-amount"></p>
            </div>
        </div>
    </div>

    <!-- ì‹¤í–‰ í”Œëœ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸš€ ë‹¨ê³„ë³„ ì‹¤í–‰ í”Œëœ</h2>

        <div class="flex items-stretch gap-2 mb-6 text-sm">
            <!-- 1ë‹¨ê³„ -->
            <div class="w-1/3 step-card border-green-200 bg-green-50/30">
                <div class="flex items-center gap-2 mb-2">
                    <span
                        class="w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center font-bold text-xs">1</span>
                    <h3 class="font-bold text-green-800">ëª¨ìœ¼ëŠ” ê¸°ê°„</h3>
                </div>
                <div class="space-y-2">
                    <p class="flex justify-between"><span>ê¸°ê°„:</span> <span class="font-bold" id="save-years"></span></p>
                    <p class="flex justify-between"><span>ìˆ˜ìµë¥ :</span> <span class="font-bold" id="save-rate"></span></p>
                    <div class="pt-2 border-t border-green-100">
                        <p class="text-xs text-gray-500">ë§¤ì›” ì €ì¶•ì•¡</p>
                        <p class="text-xl font-bold text-green-700 mt-1" id="monthly-save"></p>
                    </div>
                </div>
            </div>

            <div class="flex flex-col justify-center text-gray-400 text-xl font-bold">â–¶</div>

            <!-- 2ë‹¨ê³„ -->
            <div class="w-1/3 step-card border-purple-200 bg-purple-50/30">
                <div class="flex items-center gap-2 mb-2">
                    <span
                        class="w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center font-bold text-xs">2</span>
                    <h3 class="font-bold text-purple-800">ë¶ˆë¦¬ëŠ” ê¸°ê°„ (ê±°ì¹˜)</h3>
                </div>
                <div class="space-y-2">
                    <p class="flex justify-between"><span>ê¸°ê°„:</span> <span class="font-bold" id="defer-years"></span>
                    </p>
                    <p class="flex justify-between"><span>ìˆ˜ìµë¥ :</span> <span class="font-bold" id="defer-rate"></span>
                    </p>
                    <div class="pt-2 border-t border-purple-100">
                        <p class="text-xs text-gray-500">ê±°ì¹˜ ì›ê¸ˆ</p>
                        <p class="text-lg font-bold text-purple-700 mt-1" id="defer-principal"></p>
                    </div>
                </div>
            </div>

            <div class="flex flex-col justify-center text-gray-400 text-xl font-bold">â–¶</div>

            <!-- 3ë‹¨ê³„ -->
            <div class="w-1/3 step-card border-amber-200 bg-amber-50/30">
                <div class="flex items-center gap-2 mb-2">
                    <span
                        class="w-6 h-6 bg-amber-500 text-white rounded-full flex items-center justify-center font-bold text-xs">3</span>
                    <h3 class="font-bold text-amber-800">ì€í‡´ (í™©ê¸ˆ ê±°ìœ„)</h3>
                </div>
                <div class="space-y-2">
                    <p class="flex justify-between"><span>ë‹¬ì„± ë‚˜ì´:</span> <span class="font-bold" id="final-age"></span>
                    </p>
                    <div class="pt-2 border-t border-amber-100">
                        <p class="text-xs text-gray-500">ìµœì¢… ìì‚°</p>
                        <p class="text-xl font-black text-amber-600 mt-1" id="final-amount"></p>
                    </div>
                    <div class="bg-amber-100 rounded p-2 mt-2 text-center">
                        <p class="text-xs font-bold text-amber-800">í‰ìƒ ì›” ë°°ë‹¹ê¸ˆ</p>
                        <p class="text-lg font-black text-amber-700" id="final-pension"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì‹œê°í™” ì°¨íŠ¸ -->
        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-bold text-gray-500 mb-3 text-center">ìì‚° ì„±ì¥ ì‹œë®¬ë ˆì´ì…˜</h3>
            <canvas id="reportChart" style="max-height: 250px;"></canvas>
        </div>
    </div>

    <!-- ê¶Œì¥ ì‚¬í•­ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ’¡ ì¬ë¬´ ì„¤ê³„ì‚¬ ê¶Œì¥ ì‚¬í•­</h2>
        <div class="bg-amber-50 p-6 rounded-lg border-l-4 border-amber-500">
            <ul class="space-y-2 text-gray-700">
                <li class="flex items-start gap-2">
                    <span class="text-amber-600 font-bold">â€¢</span>
                    <span>1ë‹¨ê³„ ì €ì¶• ê¸°ê°„(<span id="rec-save-years"></span>ë…„) ë™ì•ˆ ì›” <span id="rec-monthly"
                            class="font-bold text-green-700"></span> ë‚©ì…ì„ ìµœìš°ì„  ëª©í‘œë¡œ ì‚¼ìœ¼ì„¸ìš”.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-amber-600 font-bold">â€¢</span>
                    <span>2ë‹¨ê³„ ê±°ì¹˜ ê¸°ê°„ ë™ì•ˆì—ëŠ” ì¶”ê°€ ë¶ˆì… ì—†ì´ë„ ë³µë¦¬ íš¨ê³¼ë¡œ ìì‚°ì´ ì•½ <span id="rec-growth-rate" class="font-bold"></span>ë°°
                        ì„±ì¥í•©ë‹ˆë‹¤. ì¸ë‚´ì‹¬ì´ í•„ìš”í•©ë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-amber-600 font-bold">â€¢</span>
                    <span>ìµœì¢…ì ìœ¼ë¡œ ë§ˆë ¨ëœ 'í™©ê¸ˆ ê±°ìœ„'ëŠ” ì›ê¸ˆì„ ê±´ë“œë¦¬ì§€ ì•Šê³  ë°°ë‹¹ê¸ˆë§Œìœ¼ë¡œ ìƒí™œë¹„ë¥¼ ì¶©ë‹¹í•˜ëŠ” ê°€ì¥ ì•ˆì „í•œ ì€í‡´ ëª¨ë¸ì…ë‹ˆë‹¤.</span>
                </li>
            </ul>
        </div>
    </div>

    <!-- ë©´ì±… ì¡°í•­ -->
    <div class="report-section text-xs text-gray-500 border-t pt-4 mt-8">
        <p class="mb-2">
            <strong>ë©´ì±… ì¡°í•­:</strong> ë³¸ ë³´ê³ ì„œì˜ ë¶„ì„ ê²°ê³¼ëŠ” ì…ë ¥ëœ ê°€ì •ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹œë®¬ë ˆì´ì…˜ì´ë©°, ì‹¤ì œ íˆ¬ì ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            íˆ¬ì ê²°ì • ì‹œì—ëŠ” ì‹œì¥ ìƒí™©, ê°œì¸ì˜ ì¬ë¬´ ìƒíƒœ, ë¦¬ìŠ¤í¬ ì„±í–¥ ë“±ì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
        </p>
        <p class="text-center mt-4 text-gray-400">
            Â© 2024-2026 ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨. All rights reserved.
        </p>
    </div>

    <script>
        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const params = new URLSearchParams(window.location.search);

        // ë‚ ì§œ ì„¤ì •
        document.getElementById('report-date').textContent = new Date().toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // ë°ì´í„° íŒŒì‹±
        const reportData = {
            clientName: params.get('clientName') || 'ê³ ê°ëª…',
            clientAge: params.get('clientAge') || '40',
            purpose: params.get('purpose') || 'í–‰ë³µí•œ ë…¸í›„',
            retireAge: parseInt(params.get('retireAge')) || 65,

            monthlyPension: parseInt(params.get('monthlyPension')) || 0,
            targetAmount: parseInt(params.get('targetAmount')) || 0,

            saveYears: parseInt(params.get('saveYears')) || 10,
            saveRate: parseFloat(params.get('saveRate')) || 5,

            deferYears: parseInt(params.get('deferYears')) || 15,
            deferRate: parseFloat(params.get('deferRate')) || 5,

            monthlySave: parseInt(params.get('monthlySave')) || 0,
            stage1Amount: parseInt(params.get('stage1Amount')) || 0,
            stage2Amount: parseInt(params.get('stage2Amount')) || 0
        };

        const formatMoney = (n) => new Intl.NumberFormat('ko-KR').format(Math.round(n)) + 'ì›';

        // ê³ ê° ì •ë³´ í‘œì‹œ
        document.getElementById('client-name').textContent = reportData.clientName;
        document.getElementById('client-age').textContent = reportData.clientAge + 'ì„¸';
        document.getElementById('analysis-purpose').textContent = reportData.purpose;
        document.getElementById('retire-age-val').textContent = reportData.retireAge;

        // ì€í‡´ ëª©í‘œ
        document.getElementById('monthly-pension').textContent = formatMoney(reportData.monthlyPension);
        document.getElementById('target-amount').textContent = formatMoney(reportData.targetAmount);

        // ì‹¤í–‰ í”Œëœ - 1ë‹¨ê³„
        document.getElementById('save-years').textContent = reportData.saveYears + 'ë…„';
        document.getElementById('save-rate').textContent = reportData.saveRate + '%';
        document.getElementById('monthly-save').textContent = formatMoney(reportData.monthlySave);

        // ì‹¤í–‰ í”Œëœ - 2ë‹¨ê³„
        document.getElementById('defer-years').textContent = reportData.deferYears + 'ë…„';
        document.getElementById('defer-rate').textContent = reportData.deferRate + '%';
        document.getElementById('defer-principal').textContent = formatMoney(reportData.stage1Amount);

        // ì‹¤í–‰ í”Œëœ - 3ë‹¨ê³„ (ê²°ê³¼)
        document.getElementById('final-age').textContent = reportData.retireAge + 'ì„¸';
        document.getElementById('final-amount').textContent = formatMoney(reportData.stage2Amount);
        document.getElementById('final-pension').textContent = formatMoney(reportData.monthlyPension);

        // ê¶Œì¥ ì‚¬í•­
        document.getElementById('rec-save-years').textContent = reportData.saveYears;
        document.getElementById('rec-monthly').textContent = formatMoney(reportData.monthlySave);

        const growthRate = reportData.stage2Amount / reportData.stage1Amount;
        document.getElementById('rec-growth-rate').textContent = growthRate.toFixed(1);


        // ì°¨íŠ¸ ë°ì´í„° ìƒì„±
        // 1ë‹¨ê³„ (ì €ì¶•)
        const stage1Data = [];
        let currentAmount = 0;
        const saveRateMonthly = reportData.saveRate / 100 / 12;
        const startAge = parseInt(reportData.clientAge);

        // 0ë…„ì°¨
        stage1Data.push({ x: 'ì‹œì‘', y: 0 });

        // 1ë‹¨ê³„ ê³¼ì • ìƒëµí•˜ê³  ê²°ê³¼ë§Œ (ë‹¨ìˆœí™”ë¥¼ ìœ„í•´)
        stage1Data.push({ x: (startAge + reportData.saveYears) + 'ì„¸', y: reportData.stage1Amount });

        // 2ë‹¨ê³„ (ê±°ì¹˜)
        stage1Data.push({ x: reportData.retireAge + 'ì„¸', y: reportData.stage2Amount });

        // ì°¨íŠ¸ ë¼ë²¨ ë° ë°ì´í„°
        const labels = ['ì‹œì‘ (' + startAge + 'ì„¸)', '1ë‹¨ê³„ ì™„ë£Œ (' + (startAge + reportData.saveYears) + 'ì„¸)', 'ì€í‡´ (' + reportData.retireAge + 'ì„¸)'];
        const dataValues = [0, reportData.stage1Amount, reportData.stage2Amount];

        // ì°¨íŠ¸ ìƒì„±
        const ctx = document.getElementById('reportChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'ìì‚° ì„±ì¥',
                        data: dataValues,
                        borderColor: '#d97706',
                        backgroundColor: 'rgba(217, 119, 6, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#d97706',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        fill: true,
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: (ctx) => ' ìì‚°: ' + formatMoney(ctx.parsed.y)
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: (value) => {
                                if (value >= 100000000) return (value / 100000000).toFixed(0) + 'ì–µ';
                                if (value >= 10000) return (value / 10000).toFixed(0) + 'ë§Œ';
                                return value;
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>

</html>