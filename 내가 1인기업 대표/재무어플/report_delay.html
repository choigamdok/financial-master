<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íˆ¬ì ì§€ì—° ë¹„ìš© ë¶„ì„ ë³´ê³ ì„œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: white;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-after: always;
            }
        }

        .report-header {
            border-bottom: 4px solid #ef4444;
            padding-bottom: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-section {
            margin-bottom: 2rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            border: 1px solid #e5e7eb;
            padding: 0.75rem;
            text-align: left;
        }

        .data-table th {
            background-color: #f3f4f6;
            font-weight: 600;
        }

        .highlight-box {
            background: linear-gradient(135deg, #ef4444 0%, #b91c1c 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
        }
    </style>
</head>

<body class="p-8 max-w-4xl mx-auto">
    <!-- í”„ë¦°íŠ¸ ë²„íŠ¼ -->
    <div class="no-print mb-6 text-right">
        <button onclick="window.print()"
            class="bg-red-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-700 transition">
            ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥
        </button>
    </div>

    <!-- í—¤ë” -->
    <div class="report-header">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-3xl font-black text-gray-900 mb-2">íˆ¬ì ì§€ì—° ë¹„ìš© ë¶„ì„</h1>
                <p class="text-sm text-gray-500">Cost of Delay Analysis Report</p>
            </div>
            <div class="text-right text-sm text-gray-600">
                <p id="report-date"></p>
                <p class="font-bold text-red-600 mt-1">ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨</p>
            </div>
        </div>
    </div>

    <!-- ê³ ê° ì •ë³´ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ“‹ ê³ ê° ì •ë³´</h2>
        <table class="data-table">
            <tr>
                <th class="w-1/4">ê³ ê°ëª…</th>
                <td id="client-name"></td>
                <th class="w-1/4">ë‚˜ì´</th>
                <td id="client-age"></td>
            </tr>
            <tr>
                <th>ì¬ë¬´ ëª©ì </th>
                <td colspan="3" id="analysis-purpose"></td>
            </tr>
        </table>
    </div>

    <!-- ë¶„ì„ ì¡°ê±´ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ“Š ë¶„ì„ ì¡°ê±´</h2>
        <div class="grid grid-cols-2 gap-4">
            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                <p class="text-sm text-gray-600 mb-1">ëª©í‘œ ê¸ˆì•¡</p>
                <p class="text-2xl font-bold text-gray-900" id="target-amount"></p>
            </div>
            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                <p class="text-sm text-blue-800 mb-1">ì´ ì¤€ë¹„ ê¸°ê°„</p>
                <p class="text-2xl font-bold text-blue-700" id="total-years"></p>
            </div>
            <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                <p class="text-sm text-red-800 mb-1">ì§€ì—° ê¸°ê°„</p>
                <p class="text-2xl font-bold text-red-700" id="delay-years"></p>
            </div>
            <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                <p class="text-sm text-green-800 mb-1">ì˜ˆìƒ ìˆ˜ìµë¥ </p>
                <p class="text-2xl font-bold text-green-700" id="rate"></p>
            </div>
        </div>
    </div>

    <!-- ë¶„ì„ ê²°ê³¼ ë¹„êµ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">âš–ï¸ ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ</h2>

        <div class="grid grid-cols-2 gap-6 mb-6">
            <!-- ì§€ê¸ˆ ì‹œì‘ -->
            <div class="border rounded-xl p-5 border-blue-200 bg-blue-50/50">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-blue-900 text-lg">âœ… ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘</h3>
                    <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded font-bold">BEST</span>
                </div>
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-gray-600">ì¤€ë¹„ ê¸°ê°„</span>
                        <span class="font-bold text-gray-900" id="now-period"></span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">ì›” ì €ì¶•ì•¡</span>
                        <span class="font-bold text-blue-600 text-lg" id="now-monthly"></span>
                    </div>
                    <div class="pt-3 border-t border-blue-200 flex justify-between">
                        <span class="text-gray-700 font-semibold">ì´ ë‚©ì… ì›ê¸ˆ</span>
                        <span class="font-black text-gray-900" id="now-total"></span>
                    </div>
                </div>
            </div>

            <!-- ì§€ì—° ì‹œì‘ -->
            <div class="border rounded-xl p-5 border-red-200 bg-red-50/50">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-red-900 text-lg">âš ï¸ <span id="delay-val"></span>ë…„ ë’¤ ì‹œì‘</h3>
                    <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded font-bold">WARNING</span>
                </div>
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-gray-600">ì¤€ë¹„ ê¸°ê°„</span>
                        <span class="font-bold text-gray-900" id="delay-period"></span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">ì›” ì €ì¶•ì•¡</span>
                        <span class="font-bold text-red-600 text-lg" id="delay-monthly"></span>
                    </div>
                    <div class="pt-3 border-t border-red-200 flex justify-between">
                        <span class="text-gray-700 font-semibold">ì´ ë‚©ì… ì›ê¸ˆ</span>
                        <span class="font-black text-gray-900" id="delay-total"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê²Œìœ¼ë¦„ ë¹„ìš© ê²°ê³¼ -->
        <div class="highlight-box mb-8">
            <p class="text-red-100 mb-2 font-medium">ë‹¹ì‹ ì´ ì¹˜ëŸ¬ì•¼ í•  "ê²Œìœ¼ë¦„ ë¹„ìš©"</p>
            <p class="text-4xl font-black mb-2" id="delay-cost"></p>
            <p class="text-sm text-red-100 opacity-90">ëŠ¦ê²Œ ì‹œì‘í•˜ë©´ ì´ë§Œí¼ ë” ë‚´ì•¼ ëª©í‘œë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <!-- ì°¨íŠ¸ -->
        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-bold text-gray-500 mb-3 text-center">ì´ ë‚©ì… ì›ê¸ˆ ë¹„êµ</h3>
            <canvas id="reportChart" style="max-height: 250px;"></canvas>
        </div>
    </div>

    <!-- ê¶Œì¥ ì‚¬í•­ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ’¡ ì¬ë¬´ ì„¤ê³„ì‚¬ ì¡°ì–¸</h2>
        <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-gray-500">
            <ul class="space-y-2 text-gray-700">
                <li class="flex items-start gap-2">
                    <span class="text-red-600 font-bold">!</span>
                    <span><span class="font-bold text-red-600">ì‹œê°„ì€ ëˆì…ë‹ˆë‹¤.</span> íˆ¬ìë¥¼ ë¯¸ë£¨ëŠ” ëª¨ë“  ìˆœê°„ì´ ë¹„ìš©ìœ¼ë¡œ ëŒì•„ì˜µë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-blue-600 font-bold">â€¢</span>
                    <span>ì§€ê¸ˆ ì‹œì‘í•˜ë©´ ì›” <span id="rec-now-monthly" class="font-bold text-blue-600"></span>ìœ¼ë¡œ ì¶©ë¶„í•˜ì§€ë§Œ,
                        <span id="rec-delay-years" class="font-bold"></span>ë…„ë§Œ ëŠ¦ì–´ì ¸ë„ ì›” <span id="rec-delay-monthly"
                            class="font-bold text-red-600"></span>ì„ ì €ì¶•í•´ì•¼ í•©ë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-blue-600 font-bold">â€¢</span>
                    <span>ë¶€ë‹´ ì—†ëŠ” ê¸ˆì•¡ì´ë¼ë„ <span class="font-bold border-b-2 border-blue-200">ì§€ê¸ˆ ë‹¹ì¥ ì‹œì‘</span>í•˜ëŠ” ê²ƒì´ ê°€ì¥ í˜„ëª…í•œ íˆ¬ì
                        ì „ëµì…ë‹ˆë‹¤.</span>
                </li>
            </ul>
        </div>
    </div>

    <!-- ë©´ì±… ì¡°í•­ -->
    <div class="report-section text-xs text-gray-500 border-t pt-4 mt-8">
        <p class="mb-2">
            <strong>ë©´ì±… ì¡°í•­:</strong> ë³¸ ë³´ê³ ì„œì˜ ë¶„ì„ ê²°ê³¼ëŠ” ì…ë ¥ëœ ê°€ì •ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹œë®¬ë ˆì´ì…˜ì´ë©°, ì‹¤ì œ íˆ¬ì ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            íˆ¬ì ê²°ì • ì‹œì—ëŠ” ì‹œì¥ ìƒí™©, ê°œì¸ì˜ ì¬ë¬´ ìƒíƒœ, ë¦¬ìŠ¤í¬ ì„±í–¥ ë“±ì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
        </p>
        <p class="text-center mt-4 text-gray-400">
            Â© 2024-2026 ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨. All rights reserved.
        </p>
    </div>

    <script>
        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const params = new URLSearchParams(window.location.search);

        // ë‚ ì§œ ì„¤ì •
        document.getElementById('report-date').textContent = new Date().toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // ë°ì´í„° íŒŒì‹±
        const reportData = {
            clientName: params.get('clientName') || 'ê³ ê°ëª…',
            clientAge: params.get('clientAge') || '-',
            purpose: params.get('purpose') || 'ì€í‡´ ìê¸ˆ',
            targetAmount: parseInt(params.get('targetAmount')) || 0,
            totalYears: parseInt(params.get('totalYears')) || 20,
            delayYears: parseInt(params.get('delayYears')) || 5,
            rate: parseFloat(params.get('rate')) || 6,
            nowMonthly: parseInt(params.get('nowMonthly')) || 0,
            nowTotal: parseInt(params.get('nowTotal')) || 0,
            delayMonthly: parseInt(params.get('delayMonthly')) || 0,
            delayTotal: parseInt(params.get('delayTotal')) || 0,
            delayCost: parseInt(params.get('delayCost')) || 0
        };

        const formatMoney = (n) => new Intl.NumberFormat('ko-KR').format(Math.round(n)) + 'ì›';

        // ê³ ê° ì •ë³´ í‘œì‹œ
        document.getElementById('client-name').textContent = reportData.clientName;
        document.getElementById('client-age').textContent = reportData.clientAge + 'ì„¸';
        document.getElementById('analysis-purpose').textContent = reportData.purpose;

        // ë¶„ì„ ì¡°ê±´ í‘œì‹œ
        document.getElementById('target-amount').textContent = formatMoney(reportData.targetAmount);
        document.getElementById('total-years').textContent = reportData.totalYears + 'ë…„';
        document.getElementById('delay-years').textContent = reportData.delayYears + 'ë…„';
        document.getElementById('rate').textContent = reportData.rate + '%';

        // ë¶„ì„ ê²°ê³¼ í‘œì‹œ (ì§€ê¸ˆ ì‹œì‘)
        document.getElementById('now-period').textContent = reportData.totalYears + 'ë…„';
        document.getElementById('now-monthly').textContent = formatMoney(reportData.nowMonthly);
        document.getElementById('now-total').textContent = formatMoney(reportData.nowTotal);

        // ë¶„ì„ ê²°ê³¼ í‘œì‹œ (ì§€ì—° ì‹œì‘)
        document.getElementById('delay-val').textContent = reportData.delayYears;
        document.getElementById('delay-period').textContent = (reportData.totalYears - reportData.delayYears) + 'ë…„';
        document.getElementById('delay-monthly').textContent = formatMoney(reportData.delayMonthly);
        document.getElementById('delay-total').textContent = formatMoney(reportData.delayTotal);

        // ê²Œìœ¼ë¦„ ë¹„ìš©
        document.getElementById('delay-cost').textContent = formatMoney(reportData.delayCost);

        // ê¶Œì¥ ì‚¬í•­
        document.getElementById('rec-now-monthly').textContent = formatMoney(reportData.nowMonthly);
        document.getElementById('rec-delay-years').textContent = reportData.delayYears;
        document.getElementById('rec-delay-monthly').textContent = formatMoney(reportData.delayMonthly);

        // ì°¨íŠ¸ ìƒì„±
        const ctx = document.getElementById('reportChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['ì§€ê¸ˆ ì‹œì‘', reportData.delayYears + 'ë…„ ì§€ì—° ì‹œì‘'],
                datasets: [
                    {
                        label: 'ì´ ë‚©ì… ì›ê¸ˆ',
                        data: [reportData.nowTotal, reportData.delayTotal],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.7)', // Blue
                            'rgba(239, 68, 68, 0.7)'   // Red
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(239, 68, 68)'
                        ],
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: (ctx) => ' ì´ ë‚©ì… ì›ê¸ˆ: ' + formatMoney(ctx.parsed.x)
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            callback: (value) => {
                                if (value >= 100000000) return (value / 100000000).toFixed(1) + 'ì–µ';
                                if (value >= 10000) return (value / 10000).toFixed(0) + 'ë§Œ';
                                return value;
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>

</html>