<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¬ë¬´ ë¶„ì„ ë³´ê³ ì„œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: white;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-after: always;
            }
        }

        .report-header {
            border-bottom: 4px solid #2563eb;
            padding-bottom: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-section {
            margin-bottom: 2rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            border: 1px solid #e5e7eb;
            padding: 0.75rem;
            text-align: left;
        }

        .data-table th {
            background-color: #f3f4f6;
            font-weight: 600;
        }

        .highlight-box {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
        }
    </style>
</head>

<body class="p-8 max-w-4xl mx-auto">
    <!-- í”„ë¦°íŠ¸ ë²„íŠ¼ -->
    <div class="no-print mb-6 text-right">
        <button onclick="window.print()"
            class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700 transition">
            ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥
        </button>
    </div>

    <!-- í—¤ë” -->
    <div class="report-header">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-3xl font-black text-gray-900 mb-2">ì¬ë¬´ ë¶„ì„ ë³´ê³ ì„œ</h1>
                <p class="text-sm text-gray-500">Financial Analysis Report</p>
            </div>
            <div class="text-right text-sm text-gray-600">
                <p id="report-date"></p>
                <p class="font-bold text-blue-600 mt-1">ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨</p>
            </div>
        </div>
    </div>

    <!-- ê³ ê° ì •ë³´ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ“‹ ê³ ê° ì •ë³´</h2>
        <table class="data-table">
            <tr>
                <th class="w-1/4">ê³ ê°ëª…</th>
                <td id="client-name"></td>
                <th class="w-1/4">ë‚˜ì´</th>
                <td id="client-age"></td>
            </tr>
            <tr>
                <th>ë¶„ì„ ëª©ì </th>
                <td colspan="3" id="analysis-purpose"></td>
            </tr>
        </table>
    </div>

    <!-- ìˆ˜ìµìœ¨ ë¹„êµ ë¶„ì„ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ“Š ìˆ˜ìµìœ¨ ë¹„êµ ë¶„ì„</h2>

        <!-- ì…ë ¥ ì •ë³´ ìš”ì•½ -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ë¶„ì„ ì¡°ê±´</h3>
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <p class="text-sm text-gray-600 mb-1">ì´ˆê¸° íˆ¬ì ì›ê¸ˆ</p>
                    <p class="text-2xl font-bold text-gray-900" id="principal-amount"></p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <p class="text-sm text-gray-600 mb-1">íˆ¬ì ê¸°ê°„</p>
                    <p class="text-2xl font-bold text-gray-900" id="duration-years"></p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <p class="text-sm text-blue-800 mb-1">Plan A ìˆ˜ìµë¥  (ë³´ìˆ˜ì )</p>
                    <p class="text-2xl font-bold text-blue-700" id="rate-a"></p>
                </div>
                <div class="bg-amber-50 p-4 rounded-lg border border-amber-200">
                    <p class="text-sm text-amber-800 mb-1">Plan B ìˆ˜ìµë¥  (ì ê·¹ì )</p>
                    <p class="text-2xl font-bold text-amber-700" id="rate-b"></p>
                </div>
            </div>
        </div>

        <!-- ë¶„ì„ ê²°ê³¼ -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ë¶„ì„ ê²°ê³¼</h3>
            <div class="grid grid-cols-3 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 text-center">
                    <p class="text-sm text-blue-800 mb-1">Plan A ìµœì¢… ìì‚°</p>
                    <p class="text-xl font-black text-blue-700" id="result-total-a"></p>
                    <p class="text-xs text-gray-600 mt-1">ëˆ„ì  ìˆ˜ìµë¥ : <span id="result-rate-a"></span></p>
                </div>
                <div class="bg-amber-50 p-4 rounded-lg border border-amber-200 text-center">
                    <p class="text-sm text-amber-800 mb-1">Plan B ìµœì¢… ìì‚°</p>
                    <p class="text-xl font-black text-amber-700" id="result-total-b"></p>
                    <p class="text-xs text-gray-600 mt-1">ëˆ„ì  ìˆ˜ìµë¥ : <span id="result-rate-b"></span></p>
                </div>
                <div class="highlight-box">
                    <p class="text-sm text-blue-100 mb-1">ì°¨ìµ</p>
                    <p class="text-2xl font-black" id="result-diff"></p>
                    <p class="text-xs text-blue-100 mt-1">Plan B - Plan A</p>
                </div>
            </div>
        </div>

        <!-- ì°¨íŠ¸ -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ìì‚° ì„±ì¥ ì¶”ì´</h3>
            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                <canvas id="reportChart" style="max-height: 300px;"></canvas>
            </div>
        </div>

        <!-- ìƒì„¸ í…Œì´ë¸” -->
        <div class="page-break">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">ì—°ë„ë³„ ìƒì„¸ ë‚´ì—­</h3>
            <table class="data-table text-sm">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="text-center">ì—°ë„</th>
                        <th class="text-center">ë‚˜ì´</th>
                        <th class="text-right">Plan A ìì‚°</th>
                        <th class="text-right">Plan B ìì‚°</th>
                        <th class="text-right">ì°¨ì•¡</th>
                    </tr>
                </thead>
                <tbody id="detail-table-body">
                    <!-- JavaScriptë¡œ ìƒì„± -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- ê¶Œì¥ ì‚¬í•­ -->
    <div class="report-section">
        <h2 class="text-xl font-bold text-gray-900 mb-4 pb-2 border-b-2 border-gray-200">ğŸ’¡ ì¬ë¬´ ì„¤ê³„ì‚¬ ê¶Œì¥ ì‚¬í•­</h2>
        <div class="bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500">
            <ul class="space-y-2 text-gray-700">
                <li class="flex items-start gap-2">
                    <span class="text-blue-600 font-bold">â€¢</span>
                    <span>ë¶„ì„ ê²°ê³¼, <span class="font-bold text-blue-700">ì ê·¹ì  ìš´ìš©(Plan B)</span>ì´ ì¥ê¸°ì ìœ¼ë¡œ <span
                            id="recommendation-diff" class="font-bold"></span> ë” ë†’ì€ ìˆ˜ìµì„ ì œê³µí•©ë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-blue-600 font-bold">â€¢</span>
                    <span>ë‹¤ë§Œ, ë†’ì€ ìˆ˜ìµë¥ ì€ ë†’ì€ ë³€ë™ì„±ì„ ë™ë°˜í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ê³ ê°ë‹˜ì˜ ë¦¬ìŠ¤í¬ ì„±í–¥ê³¼ íˆ¬ì ëª©í‘œë¥¼ ê³ ë ¤í•˜ì—¬ ê²°ì •í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-blue-600 font-bold">â€¢</span>
                    <span>ì •ê¸°ì ì¸ í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ë°¸ëŸ°ì‹±ê³¼ ì¬ë¬´ ìƒíƒœ ì ê²€ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.</span>
                </li>
            </ul>
        </div>
    </div>

    <!-- ë©´ì±… ì¡°í•­ -->
    <div class="report-section text-xs text-gray-500 border-t pt-4 mt-8">
        <p class="mb-2">
            <strong>ë©´ì±… ì¡°í•­:</strong> ë³¸ ë³´ê³ ì„œì˜ ë¶„ì„ ê²°ê³¼ëŠ” ì…ë ¥ëœ ê°€ì •ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹œë®¬ë ˆì´ì…˜ì´ë©°, ì‹¤ì œ íˆ¬ì ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            íˆ¬ì ê²°ì • ì‹œì—ëŠ” ì‹œì¥ ìƒí™©, ê°œì¸ì˜ ì¬ë¬´ ìƒíƒœ, ë¦¬ìŠ¤í¬ ì„±í–¥ ë“±ì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
        </p>
        <p class="text-center mt-4 text-gray-400">
            Â© 2024-2026 ê¸ˆì‡¼ë§˜ì˜ ê¸ˆìœµìŠ¤ì¿¨. All rights reserved.
        </p>
    </div>

    <script>
        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const params = new URLSearchParams(window.location.search);

        // ë‚ ì§œ ì„¤ì •
        document.getElementById('report-date').textContent = new Date().toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // ë°ì´í„° íŒŒì‹±
        const reportData = {
            clientName: params.get('clientName') || 'ê³ ê°ëª…',
            clientAge: params.get('clientAge') || '-',
            purpose: params.get('purpose') || 'ìì‚° ì„±ì¥ ë¶„ì„',
            principal: parseInt(params.get('principal')) || 50000000,
            duration: parseInt(params.get('duration')) || 30,
            age: parseInt(params.get('age')) || 35,
            rateA: parseFloat(params.get('rateA')) || 3.5,
            rateB: parseFloat(params.get('rateB')) || 7.0,
            totalA: parseInt(params.get('totalA')) || 0,
            totalB: parseInt(params.get('totalB')) || 0,
            accRateA: parseFloat(params.get('accRateA')) || 0,
            accRateB: parseFloat(params.get('accRateB')) || 0,
            diff: parseInt(params.get('diff')) || 0
        };

        const formatMoney = (n) => new Intl.NumberFormat('ko-KR').format(Math.round(n)) + 'ì›';

        // ê³ ê° ì •ë³´ í‘œì‹œ
        document.getElementById('client-name').textContent = reportData.clientName;
        document.getElementById('client-age').textContent = reportData.clientAge + 'ì„¸';
        document.getElementById('analysis-purpose').textContent = reportData.purpose;

        // ë¶„ì„ ì¡°ê±´ í‘œì‹œ
        document.getElementById('principal-amount').textContent = formatMoney(reportData.principal);
        document.getElementById('duration-years').textContent = reportData.duration + 'ë…„';
        document.getElementById('rate-a').textContent = reportData.rateA + '%';
        document.getElementById('rate-b').textContent = reportData.rateB + '%';

        // ê²°ê³¼ í‘œì‹œ
        document.getElementById('result-total-a').textContent = formatMoney(reportData.totalA);
        document.getElementById('result-total-b').textContent = formatMoney(reportData.totalB);
        document.getElementById('result-rate-a').textContent = reportData.accRateA.toFixed(0) + '%';
        document.getElementById('result-rate-b').textContent = reportData.accRateB.toFixed(0) + '%';
        document.getElementById('result-diff').textContent = formatMoney(reportData.diff);
        document.getElementById('recommendation-diff').textContent = formatMoney(reportData.diff);

        // ì—°ë„ë³„ ë°ì´í„° ê³„ì‚° ë° í…Œì´ë¸” ìƒì„±
        const yearlyData = [];
        for (let i = 1; i <= reportData.duration; i++) {
            const totalA = reportData.principal * Math.pow((1 + reportData.rateA / 100), i);
            const totalB = reportData.principal * Math.pow((1 + reportData.rateB / 100), i);
            yearlyData.push({
                year: i,
                age: reportData.age + i,
                totalA,
                totalB,
                diff: totalB - totalA
            });
        }

        // í…Œì´ë¸” ìƒì„± (5ë…„ ë‹¨ìœ„ë§Œ)
        const tableBody = document.getElementById('detail-table-body');
        yearlyData.forEach((data, idx) => {
            if (data.year % 5 === 0 || data.year === reportData.duration) {
                const row = `
                    <tr class="${data.year === reportData.duration ? 'bg-blue-50 font-bold' : ''}">
                        <td class="text-center">${data.year}ë…„</td>
                        <td class="text-center">${data.age}ì„¸</td>
                        <td class="text-right">${formatMoney(data.totalA)}</td>
                        <td class="text-right">${formatMoney(data.totalB)}</td>
                        <td class="text-right text-blue-600">+${formatMoney(data.diff)}</td>
                    </tr>
                `;
                tableBody.insertAdjacentHTML('beforeend', row);
            }
        });

        // ì°¨íŠ¸ ìƒì„±
        const ctx = document.getElementById('reportChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: yearlyData.map(d => d.year + 'ë…„'),
                datasets: [
                    {
                        label: 'Plan A (ë³´ìˆ˜ì )',
                        data: yearlyData.map(d => d.totalA),
                        borderColor: '#2563eb',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Plan B (ì ê·¹ì )',
                        data: yearlyData.map(d => d.totalB),
                        borderColor: '#d97706',
                        backgroundColor: 'rgba(217, 119, 6, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        ticks: {
                            callback: (value) => {
                                if (value >= 100000000) return (value / 100000000).toFixed(0) + 'ì–µ';
                                if (value >= 10000) return (value / 10000).toFixed(0) + 'ë§Œ';
                                return value;
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>

</html>